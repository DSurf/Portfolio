# ๐ฏ Fraud Detection & Lead Scoring ะดะปั EdTech-ะฟะปะฐััะพัะผั

> ML-ัะธััะตะผะฐ ะฒััะฒะปะตะฝะธั ะฝะตะดะพะฑัะพัะพะฒะตััะฝัั ะธัะฟะพะปะฝะธัะตะปะตะน ะธ ะธะฝัะตะปะปะตะบััะฐะปัะฝะพะน ะฟัะธะพัะธัะธะทะฐัะธะธ ะทะฐัะฒะพะบ

[![Python](https://img.shields.io/badge/Python-3.10+-blue.svg)](https://python.org)
[![CatBoost](https://img.shields.io/badge/CatBoost-GPU-yellow.svg)](https://catboost.ai)
[![BERTopic](https://img.shields.io/badge/BERTopic-NLP-green.svg)](https://maartengr.github.io/BERTopic)

## ๐ ะะฟะธัะฐะฝะธะต ะฟัะพะตะบัะฐ

EdTech-ะฟะปะฐััะพัะผะฐ ะฟะพ ะฟะพะดะฑะพัั ัะตะฟะตัะธัะพัะพะฒ ะฟะตัะตะดะฐัั ะบะพะฝัะฐะบัั ััะตะฝะธะบะพะฒ ะธัะฟะพะปะฝะธัะตะปัะผ ะธ ะฟะพะปััะฐะตั ะบะพะผะธััะธั ั ะบะฐะถะดะพะณะพ ะฟัะพะฒะตะดัะฝะฝะพะณะพ ะทะฐะฝััะธั. ะะดะฝะฐะบะพ **~20% ะธัะฟะพะปะฝะธัะตะปะตะน** ัะบะปะพะฝััััั ะพั ะพะฟะปะฐัั ัะฐะทะปะธัะฝัะผะธ ัะฟะพัะพะฑะฐะผะธ:
- ะะฐะฝะธะถะตะฝะธะต ัะตะฐะปัะฝะพะน ััะพะธะผะพััะธ ะทะฐะฝััะธะน
- ะะตะพะฟะปะฐัะฐ ะฟัะพะฒะตะดัะฝะฝัั ััะพะบะพะฒ
- ะะฐะฝะธะฟัะปััะธะธ ั ัะฐัะฟะธัะฐะฝะธะตะผ

**ะะฐะดะฐัะฐ:** ะะพัััะพะธัั ML-ะผะพะดะตะปั ะดะปั ัะฐะฝะฝะตะณะพ ะฒััะฒะปะตะฝะธั ะฝะตะดะพะฑัะพัะพะฒะตััะฝัั ะธัะฟะพะปะฝะธัะตะปะตะน ะธ ะพะฟัะธะผะธะทะฐัะธะธ ัะฐัะฟัะตะดะตะปะตะฝะธั ะทะฐัะฒะพะบ.

## ๐๏ธ ะััะธัะตะบัััะฐ ัะตัะตะฝะธั

**Raw Data โ Feature Engineering โ Model โ Prediction**

1. ๐ฅ ะะฑัะตะดะธะฝะตะฝะธะต 6 ัะฐะฑะปะธั (833K ะทะฐะฟะธัะตะน)
2. ๐ง BERTopic: ะธะทะฒะปะตัะตะฝะธะต ~200 ัะตะผะฐัะธัะตัะบะธั ะบะปะฐััะตัะพะฒ ะธะท ัะตะบััะฐ
3. โ๏ธ ะะตะฝะตัะฐัะธั 92 ะฟัะธะทะฝะฐะบะพะฒ (ะฒัะตะผะตะฝะฝัะต, ัะตะฝะพะฒัะต, ะฟะพะฒะตะดะตะฝัะตัะบะธะต, ัะตะผะฐะฝัะธัะตัะบะธะต)
4. ๐ค ะะฑััะตะฝะธะต CatBoost ะฝะฐ GPU ั GridSearch
5. ๐ฏ ะะตะทัะปััะฐั: AUC-ROC 0.81

## ๐ ะะฐะฝะฝัะต

| ะขะฐะฑะปะธัะฐ | ะะฟะธัะฐะฝะธะต |
|---------|----------|
| `orders` | ะะฐัะฒะบะธ ะฝะฐ ะธัะฟะพะปะฝะธัะตะปะตะน |
| `teachers_info` | ะัะพัะธะปะธ ะธัะฟะพะปะฝะธัะตะปะตะน |
| `suitable_teachers` | ะะพะดัะพะดััะธะต ะธัะฟะพะปะฝะธัะตะปะธ ะดะปั ะทะฐัะฒะบะธ |
| `lessons` | ะััะพัะธั ะทะฐะฝััะธะน |
| `lesson_course` | ะัััั ััะตะฝะธะบะพะฒ |
| `teacher_prices` | ะฆะตะฝั ะธัะฟะพะปะฝะธัะตะปะตะน |

**ะัะพะณะพะฒัะน ะดะฐัะฐัะตั:** 833K ะทะฐะฟะธัะตะน ะฟะพัะปะต ะพะฑัะตะดะธะฝะตะฝะธั ัะฐะฑะปะธั

**ะฆะตะปะตะฒะพะน ะฟัะธะทะฝะฐะบ:** `target = 1` ะตัะปะธ `status_id โ {5, 6, 13, 15}` (ััะฟะตัะฝะฐั ะพะฟะปะฐัะฐ ะทะฐัะฒะบะธ)

**ะะฐะปะฐะฝั ะบะปะฐััะพะฒ:** 200K ะฟะพะปะพะถะธัะตะปัะฝัั / 633K ะพััะธัะฐัะตะปัะฝัั (~24% / 76%)

## ๐ง Feature Engineering

### ะะฐัะตะณะพัะธะธ ะฟัะธะทะฝะฐะบะพะฒ (92 ะฒัะตะณะพ):

**๐ ะัะตะผะตะฝะฝัะต** (top ะฟะพ ะฒะฐะถะฝะพััะธ)
- `day`, `month`, `weekday`, `hour`, `year`
- `time_on_platform_in_years`

**๐ค ะัะพัะธะปั ะธัะฟะพะปะฝะธัะตะปั**
- ะะพะทัะฐัั, ะพะฟัั ะฟัะตะฟะพะดะฐะฒะฐะฝะธั
- ะะตะนัะธะฝะณะธ: `rating_for_users`, `rating_for_admin`, `star_rating`
- ะคะปะฐะณะธ ะฟะพะดัะฒะตัะถะดะตะฝะธั: email, ัะตะปะตัะพะฝ

**๐ฐ ะฆะตะฝะพะฒัะต**
- `lesson_price`, `minimal_price`, `lesson_cost`
- ะะณัะตะณะฐัั: min/max/mean ะฟะพ ะธัะฟะพะปะฝะธัะตะปัะผ

**๐ ะกะตะผะฐะฝัะธัะตัะบะธะต (BERTopic)**
- `topics_purpose` โ ัะตะผะฐัะธัะตัะบะธะน ะบะปะฐััะตั ะทะฐัะฒะบะธ
- `probabilities_purpose` โ ัะฒะตัะตะฝะฝะพััั ะฒ ะบะปะฐััะตัะต
- `purpose_phrase_count` โ ะบะพะปะธัะตััะฒะพ ัะตะผ ะฒ ะทะฐัะฒะบะต

### Top-10 ะฟัะธะทะฝะฐะบะพะฒ ะฟะพ ะฒะฐะถะฝะพััะธ:

| # | ะัะธะทะฝะฐะบ | Importance |
|---|---------|------------|
| 1 | `day` | 3.12 |
| 2 | `month` | 3.08 |
| 3 | `pupil_category_new_id` | 3.03 |
| 4 | `rating_for_admin_max` | 2.63 |
| 5 | `rating_for_admin_mean` | 2.57 |
| 6 | `subject_id` | 2.48 |
| 7 | `probabilities_purpose` | 2.26 |
| 8 | `display_days_min` | 2.21 |
| 9 | `rating_mean` | 2.16 |
| 10 | `lessons_per_week` | 2.14 |

## ๐ค NLP Pipeline (BERTopic)

```python
# ะะพะดะตะปั ะดะปั ัะผะฑะตะดะดะธะฝะณะพะฒ
embedding_model = SentenceTransformer("paraphrase-multilingual-mpnet-base-v2")

# ะกะฝะธะถะตะฝะธะต ัะฐะทะผะตัะฝะพััะธ
umap_model = UMAP(n_neighbors=15, n_components=5, min_dist=0.0, metric='cosine')

# ะะปะฐััะตัะธะทะฐัะธั
hdbscan_model = HDBSCAN(min_cluster_size=15, metric='euclidean', 
                        cluster_selection_method='eom', prediction_data=True)

# BERTopic
topic_model = BERTopic(
    embedding_model=embedding_model,
    umap_model=umap_model,
    hdbscan_model=hdbscan_model,
    nr_topics=200
)
```

**ะฅะฐัะฐะบัะตัะธััะธะบะธ:**
- โฑ๏ธ ะัะตะผั ะพะฑััะตะฝะธั: 90 ะผะธะฝัั (GPU)
- ๐พ ะะฐะทะผะตั ะผะพะดะตะปะธ: 11 GB
- ๐ฏ ะัะดะตะปะตะฝะพ ~200 ัะตะผะฐะฝัะธัะตัะบะธั ะบะปะฐััะตัะพะฒ

**ะัะธะผะตัั ะบะปะฐััะตัะพะฒ:**
- `ะตะดะธะฝัะน ะณะพั. ัะบะทะฐะผะตะฝ`, `ะผะฐัะตะผะฐัะธะบะฐ`, `ะฟะพะดะณะพัะพะฒะบะฐ`
- `ะฐะฝะณะปะธะนัะบะธะน`, `ัะฐะทะณะพะฒะพัะฝัะน`, `ะฑะธะทะฝะตั`
- `python`, `ะฟัะพะณัะฐะผะผะธัะพะฒะฐะฝะธะต`, `ะฐะปะณะพัะธัะผั`

## ๐ ะะตะทัะปััะฐัั

| ะะตััะธะบะฐ | ะะฝะฐัะตะฝะธะต |
|---------|----------|
| **AUC-ROC** | **0.81** |

### ะะฐัะฐะผะตััั CatBoost (GridSearch)

```python
model = CatBoostClassifier(
    learning_rate=0.145,
    depth=12,
    l2_leaf_reg=2,
    task_type="GPU",
    devices='0:1',
    random_seed=42
)
```

## ๐ ะะฐะฟััะบ

### ะขัะตะฑะพะฒะฐะฝะธั

```bash
pip install pandas numpy catboost bertopic sentence-transformers umap-learn hdbscan matplotlib
```

### ะัะฟะพะปัะทะพะฒะฐะฝะธะต

```python
# Jupyter Notebook
jupyter notebook repetit_analysis.ipynb
```

## ๐ก ะะปััะตะฒัะต ะธะฝัะฐะนัั

1. **ะัะตะผะตะฝะฝัะต ะฟะฐััะตัะฝั ะบัะธัะธัะฝั** โ ะดะตะฝั, ะผะตััั ะธ ัะฐั ะฟะพะดะฐัะธ ะทะฐัะฒะบะธ ะฒ ัะพะฟ-10 ะฟะพ ะฒะฐะถะฝะพััะธ
2. **ะะดะผะธะฝะธัััะฐัะธะฒะฝัะน ัะตะนัะธะฝะณ > ะฟะพะปัะทะพะฒะฐัะตะปััะบะพะณะพ** โ ะฒะฝัััะตะฝะฝะธะต ะผะตััะธะบะธ ะฟะปะฐััะพัะผั ะฑะพะปะตะต ะฟัะตะดะธะบัะธะฒะฝั
3. **ะกะตะผะฐะฝัะธะบะฐ ะทะฐัะฒะพะบ ัะฐะฑะพัะฐะตั** โ BERTopic-ะฟัะธะทะฝะฐะบะธ (`probabilities_purpose`) ะฒ ัะพะฟ-10
4. **ะัะฑะปะธะบะฐัั ะทะฐัะฒะพะบ ะธะฝัะพัะผะฐัะธะฒะฝั** โ `order_number` ะฟะพะบะฐะทัะฒะฐะตั ะธััะพัะธั ะฟะตัะตะทะฐัะฒะพะบ

## ๐๏ธ ะขะตัะฝะพะปะพะณะธัะตัะบะธะน ััะตะบ

- **ML:** CatBoost, Scikit-learn
- **NLP:** BERTopic, Sentence-Transformers, UMAP, HDBSCAN
- **Data:** Pandas, NumPy, Feather
- **Visualization:** Matplotlib
- **Hardware:** NVIDIA GPU (CUDA)

## ๐ ะัะธะทะฝะฐะบะธ ะผะพัะตะฝะฝะธัะตััะฒะฐ (ะธะท ะฑะธะทะฝะตั-ะฐะฝะฐะปะธะทะฐ)

ะััะฒะปะตะฝะฝัะต ะฟะฐััะตัะฝั ะฝะตะดะพะฑัะพัะพะฒะตััะฝะพะณะพ ะฟะพะฒะตะดะตะฝะธั:
- ะะตัะพะพัะฒะตัััะฒะธะต ัะตะฝั ะฒ ะทะฐัะฒะบะต ะธ ัะตะฐะปัะฝะพะน
- 1 ะทะฐะฝััะธะต ะฝะฐ ััะตะฝะธะบะฐ (ะพัะฝะพัะตะฝะธะต ะบ ะพะฑัะตะผั ะบะพะปะธัะตััะฒั)
- ะะฐะทะฝะฐั ััะพะธะผะพััั ั ัะฐะทะฝัะผะธ ััะตะฝะธะบะฐะผะธ
- ะะฐะฝััะธั ะฒ ัะฐัะฟะธัะฐะฝะธะธ ะฑะตะท ะพะฟะปะฐั
- ะะฟะปะฐัั ััะดะพะผ ะฟะพ ะฒัะตะผะตะฝะธ (ัะฐะผะพะพะฟะปะฐัะฐ)
- ะะตะดะบะธะต ะทะฐัะพะดั ะฒ ะฟัะธะปะพะถะตะฝะธะต
- ะกัะฐััั "ะดะพะณะพะฒะพัะธะปะธัั", ะฝะพ ะพะฟะปะฐั ะฝะตั >7 ะดะฝะตะน

## ๐ ะะธัะตะฝะทะธั

MIT
